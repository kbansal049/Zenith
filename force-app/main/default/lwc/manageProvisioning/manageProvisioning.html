<!--
  @description       : 
  @author            : ChangeMeIn@UserSettingsUnder.SFDoc
  @group             : 
  @last modified on  : 10-06-2022
  @last modified by  : ChangeMeIn@UserSettingsUnder.SFDoc
-->
<template>
    <c-custom-toast-component auto-close-time="3000"></c-custom-toast-component>
    <lightning-record-view-form record-id={acctId} object-api-name="Account">
        <lightning-card variant="Narrow" title={optyName} icon-name="standard:opportunity">
            
            <template if:true={isNewTenantBtnDisabled}>
                <template if:true={newTenantBtnDisabledReasonMsg}>
                    <ul class="slds-text-align_center slds-text-color_error" style="background-color: rgb(245, 205, 155); font-weight:bold;">{newTenantBtnDisabledReasonMsg}</ul>
                </template>
                <template if:false={newTenantBtnDisabledReasonMsg}>
                    <template for:each={newTenantBtnDisabledReasons} for:item="reason" for:index="index">
                        <ul key={reason.sno} class="slds-text-align_center slds-text-color_error" style="background-color: rgb(245, 205, 155); font-weight:bold;">{reason.sno}. {reason.msg}</ul>
                    </template>
                </template>
            </template>
            <lightning-button label="Back to Opportunity" title="back to opportunity" slot="actions" onclick={navigateToOpportunityRecord} class="slds-p-right_small slds-align_absolute_right"></lightning-button>
            <lightning-button label="New Tenant Request" title="new tenant request" slot="actions" disabled={isNewTenantBtnDisabled} onclick={navigateToNewTenantComp} class="slds-p-right_small slds-align_absolute_right"></lightning-button>
            <div class="slds-p-horizontal_small">
                <div class="slds-grid">
                    <div class="slds-col slds-size_1-of-2">
                        <lightning-output-field field-name="Name"></lightning-output-field>
                        <lightning-output-field field-name="Domain__c"></lightning-output-field>
                        <lightning-output-field field-name="ZIA_Customer_Id__c"></lightning-output-field>
                        <lightning-output-field field-name="Additional_Organization_Domains__c"></lightning-output-field>
                    </div>
                    <div class="slds-col slds-size_1-of-2">
                        <lightning-output-field field-name="Type"></lightning-output-field>
                        <lightning-output-field field-name="Geo__c"></lightning-output-field>
                        <lightning-output-field field-name="Market_Segment__c"></lightning-output-field>
                    </div>
                </div>
            </div>
            <template  if:true={isaccountLoaded}>
                <lightning-spinner alternative-text="Loading..." size="small" if:true={isaccountLoaded}></lightning-spinner>
                            
            </template>
        </lightning-card>
        
    </lightning-record-view-form>
    
    <template if:true={isDraftPGExists}>
        <div class="slds-p-vertical_small"></div>
        <lightning-card variant="Narrow">
            <h3 class="slds-section-title--divider slds-m-bottom--small" style="background-color: rgb(176 196 223);color: black; text-align: center;">
                <b>Draft Provisioning</b>
            </h3>
            <lightning-layout>
                <template for:each={draftpgWrap} for:item="draftpg">
                    <lightning-layout-item flexibility="no-flex" key={draftpg.Id}>
                        <div class="slds-p-around_large slds-float_left" style="font-weight: bold; font-size:medium">{draftpg.Name}</div>
                        <div class="slds-p-around_medium slds-float_right">
                            <lightning-button-icon icon-name="utility:edit" alternative-text="edit draft" title="Edit Draft PRG" value={draftpg.Id} onclick={handleEditDraftPG} class="slds-m-left_x-small"></lightning-button-icon>
                            <lightning-button-icon icon-name="utility:archive" alternative-text="archive draft" title="Archive Draft PRG" value={draftpg.Id} onclick={handleArchiveDraftPG} class="slds-m-left_x-small"></lightning-button-icon>
                        </div>
                    </lightning-layout-item>
                </template>
            </lightning-layout>
            <template if:true={tobeArchivedDraftPGId}>
                <section role="dialog" tabindex="-1" aria-modal="true" aria-labelledby="modal-heading-01" class="slds-modal slds-fade-in-open slds-modal_medium">
                    <div class="slds-modal__container">
                        <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse">
                            <lightning-icon icon-name="utility:close" alternative-text="close" variant="inverse" size="small"></lightning-icon>
                            <span class="slds-assistive-text">Close</span>
                        </button>
                        <!--HEADER Section-->
                        <div class="slds-modal__header">
                            <h1 id="modal-heading-01" class="slds-modal__title slds-hyphenate">Archive Confirmation</h1>
                        </div>
                        <!--Body Section-->
                        <div id="modal-content-id-1" class="slds-modal__content slds-p-around_medium">
                            <p>Are you sure you want to archive this draft provisioning record?</p>
                            <lightning-spinner alternative-text="Loading..." size="small" if:true={showDraftPGStatusUpdationSpinner}></lightning-spinner>
                        </div>
                        <div class="slds-modal__footer">
                            <button class="slds-button slds-button_neutral" title="Cancel" onclick={closeDraftPGArchiveConfirmationModal}>Cancel</button>
                            <button class="slds-button slds-button_brand" title="Archive" onclick={updateDraftPGStatusToArchive}>Archive</button>
                        </div>
                        <!--Footer Section-->
                    </div>
                </section>
                <div class="slds-backdrop slds-backdrop_open" role="presentation"></div>
            </template>
        </lightning-card>
    </template>

    <template if:true={showManualProcessingMessg}>
        <div class="slds-p-vertical_small"></div>
        <lightning-card variant="Narrow">
            <h2 style="color: red;background-color:white; text-align: center;font-size: 18px;">Order Provisioning should be manually completed for this opportunity</h2>
        </lightning-card>
    </template>
    
    <template if:true={isPendingPGExists}>
        <div class="slds-p-vertical_small"></div>
        <lightning-card variant="Narrow">
            <h3 class="slds-section-title--divider slds-m-bottom--small" style="background-color: rgb(176 196 223);color: black; text-align: center;">
                <b>Pending Provisioning</b>
            </h3>
            <div class="slds-m-around_medium">
                <lightning-button label="Expand All" variant="brand-outline" disabled={isPendingExpandAllButtonDisabled} value="Pending Provisions Accordian Section" class="slds-m-around_small" onclick={expandAllActiveAccordianSections}></lightning-button>
                <lightning-button label="Collapse All" variant="brand-outline" disabled={isPendingCollapseAllButtonDisabled} value="Pending Provisions Accordian Section" class="slds-m-around_small" onclick={collapseAllActiveAccordianSections}></lightning-button>
            </div>
            <template if:true={pgWrap}>
                <template if:true={pgWrap.tenantList}>
                    <lightning-accordion allow-multiple-sections-open active-section-name={pendingProvisionActiveSections}>
                        <template for:each={pgWrap.tenantList} for:item="tenant">
                            <lightning-accordion-section name={tenant.sectionName} label={tenant.sectionName} style="font-weight: bold;" key={tenant.sectionName}>
                                <template if:true={tenant.isTrialTenant}>
                                    <div class="slds-p-vertical_small">
                                        <span class="slds-badge_lightest">
                                            <lightning-button variant="brand-outline" label={tenant.pGroup.Name} title={tenant.pGroup.Name} value={tenant.pGroup.Id} icon-name="utility:new_window" icon-position="right" class="slds-m-left_x-small" onclick={navigateToPRGRecPage}></lightning-button>&nbsp;&nbsp;&nbsp;
                                        </span>
                                        <span class="slds-badge slds-theme_info" style="background-color: rgb(235 245 255);color: black; text-align: center;">
                                            PRG Type: {tenant.pGroup.Provisioning_Type__c} &nbsp;&nbsp;||&nbsp;&nbsp; PRG Status: {tenant.pGroup.Status__c} &nbsp;&nbsp;||&nbsp;&nbsp; Product Line: {tenant.pGroup.Product_Line__c} &nbsp;&nbsp;||&nbsp;&nbsp; Process: {tenant.pGroup.Provisioning_Process__c}&nbsp;&nbsp;||&nbsp;&nbsp; Approval Status: {tenant.pGroup.Approval_Status__c}
                                        </span>
                                    </div>
                                </template>
                                <template if:true={tenant.isSubscriptionTenant}>
                                    <span class="slds-badge_lightest">
                                        <lightning-button variant="brand-outline" label={tenant.pGroup.Name} title={tenant.pGroup.Name} value={tenant.pGroup.Id} icon-name="utility:new_window" icon-position="right" class="slds-m-left_x-small" onclick={navigateToPRGRecPage}></lightning-button>&nbsp;&nbsp;&nbsp;
                                    </span>
                                    <span class="slds-badge slds-theme_info" style="background-color: rgb(235 250 240);color: black; text-align: center;">
                                        PRG Type: {tenant.pGroup.Provisioning_Type__c} &nbsp;&nbsp;||&nbsp;&nbsp; PRG Status: {tenant.pGroup.Status__c} &nbsp;&nbsp;||&nbsp;&nbsp; Product Line: {tenant.pGroup.Product_Line__c}
                                        <template if:true={tenant.pGroup.Opportunity__r.Netsuite_Sales_Order_Number__c}>
                                            &nbsp;&nbsp;||&nbsp;&nbsp; SO Number: {tenant.pGroup.Opportunity__r.Netsuite_Sales_Order_Number__c}
                                        </template>
                                        <template if:false={tenant.pGroup.Opportunity__r.Netsuite_Sales_Order_Number__c}>
                                            &nbsp;&nbsp;||&nbsp;&nbsp; SO Number: NA
                                        </template>
                                    </span>
                                    <template if:true={hasUserSubscriptionPermission}>
                                        <span class="slds-float_right">
                                            <template if:true={tenant.pGroup.Opportunity__r.SBQQ__PrimaryQuote__c}>
                                                <lightning-button-icon icon-name="utility:cart" alternative-text="show cart" title="Show Cart" value={tenant.pGroup.Opportunity__r.SBQQ__PrimaryQuote__c} onclick={navigateToShowCart} class="slds-m-left_x-small"></lightning-button-icon>
                                            </template>
                                            <template if:false={tenant.pGroup.Opportunity__r.SBQQ__PrimaryQuote__c}>
                                                <lightning-button-icon icon-name="utility:cart" alternative-text="show cart" title="Show Cart" value={tenant.pGroup.Opportunity__r.SBQQ__PrimaryQuote__c} class="slds-m-left_x-small" disabled></lightning-button-icon>
                                            </template>

                                            <template if:true={tenant.pGroup.Opportunity__r.Netsuite_Sales_Order_Number__c}>
                                                <lightning-button-icon icon-name="utility:fulfillment_order" alternative-text="netsuite sales order" title="Netsuite Sales Order" value={tenant.pGroup.Opportunity__r.Netsuite_Sales_Order_Link__c} onclick={navigateToWebPage} class="slds-m-left_x-small"></lightning-button-icon>
                                            </template>
                                            <template if:false={tenant.pGroup.Opportunity__r.Netsuite_Sales_Order_Number__c}>
                                                <lightning-button-icon icon-name="utility:fulfillment_order" alternative-text="netsuite sales order" title="Netsuite Sales Order" value={tenant.pGroup.Opportunity__r.Netsuite_Sales_Order_Link__c} class="slds-m-left_x-small" disabled></lightning-button-icon>
                                            </template>

                                            <template if:true={tenant.pGroup.ZSCM_Tenant_Link__c}>
                                                <lightning-button-icon icon-name="utility:new_window" alternative-text="zscm tenant page" title="ZSCM Tenant Page" value={tenant.pGroup.ZSCM_Tenant_Link__c} onclick={navigateToWebPage} class="slds-m-left_x-small"></lightning-button-icon>
                                            </template>
                                            <template if:false={tenant.pGroup.ZSCM_Tenant_Link__c}>
                                                <lightning-button-icon icon-name="utility:new_window" alternative-text="zscm tenant page" title="ZSCM Tenant Page" value={tenant.pGroup.ZSCM_Tenant_Link__c} class="slds-m-left_x-small" disabled></lightning-button-icon>
                                            </template>

                                            <template if:true={pgWrap.poDetailId}>
                                                <lightning-button-icon icon-name="utility:summarydetail" alternative-text="associated po detail" title="Associated PO Detail" value={pgWrap.poDetailId} onclick={navigateToPODetailPage} class="slds-m-left_x-small"></lightning-button-icon>
                                            </template>
                                            <template if:false={pgWrap.poDetailId}>
                                                <lightning-button-icon icon-name="utility:summarydetail" alternative-text="associated po detail" title="Associated PO Detail" value={pgWrap.poDetailId} class="slds-m-left_x-small" disabled></lightning-button-icon>
                                            </template>
                                            
                                            <template if:true={tenant.isWaitingForOrder}>
                                                <lightning-button-icon icon-name="utility:push" alternative-text="push for provisioning" title="Push For Provisioning(for finance)" value={tenant.pGroup.Id} class="slds-m-left_x-small" disabled></lightning-button-icon>
                                            </template>
                                            <template if:false={tenant.isWaitingForOrder}>
                                                <lightning-button-icon icon-name="utility:push" alternative-text="push for provisioning" title="Push For Provisioning(for finance)" value={tenant.pGroup.Id} onclick={handleSubmitForProvisioning} class="slds-m-left_x-small red-icon"></lightning-button-icon>
                                            </template>
                                        </span>
                                    </template>
                                </template>
                                <div class="slds-p-vertical_small">
                                    <lightning-datatable 
                                        key-field="Id" 
                                        data={tenant.pProducts} 
                                        columns={columnsTTNP} 
                                        hide-checkbox-column=true 
                                        show-row-number-column=true 
                                        resize-column-disabled=true 
                                        class="datatable-custom-style">
                                    </lightning-datatable>
                                </div>
                            </lightning-accordion-section>
                        </template>
                    </lightning-accordion>
                </template>
            </template>
        </lightning-card>
    </template>
    
    <template if:true={isProvisionedPGExists}>
        <div class="slds-p-vertical_small"></div>
        <lightning-card variant="Narrow">
            <h3 class="slds-section-title--divider slds-m-bottom--small" style="background-color: rgb(176 196 224);color: black; text-align: center;">
                <b>Provisioned Tenants</b>
            </h3>
            <lightning-tabset active-tab-value={activeTabName}>
                <lightning-tab label="Trial Tenants" value="Trial Tenants">
                    <template if:true={isAtleastOneProvisionedTrailTenantExists}>
                        <div class="slds-m-around_medium">
                            <lightning-button label="Expand All" variant="brand-outline" disabled={isProvisionedTrailTenantExpandAllButtonDisabled} value="Provisioned Trail Tenants Accordian Section" class="slds-m-around_small slds-align_absolute_right" onclick={expandAllActiveAccordianSections}></lightning-button>
                            <lightning-button label="Collapse All" variant="brand-outline" disabled={isProvisionedTrailTenantCollapseAllButtonDisabled} value="Provisioned Trail Tenants Accordian Section" class="slds-m-around_small slds-align_absolute_right" onclick={collapseAllActiveAccordianSections}></lightning-button>
                        </div>
                        <lightning-accordion allow-multiple-sections-open active-section-name={provisionedTraialTenantActiveSections}>
                            <template for:each={tenantwrap} for:item="tenant">
                                <template if:true={tenant.isTrialTenant}>
                                    <template if:true={tenant.zscObjWrapper}>
                                        <lightning-accordion-section name={tenant.zscObjWrapper.Name} label={tenant.zscObjWrapper.Name} style="font-weight: bold;" key={tenant.zscObjWrapper.Name}>
                                            <div class="slds-p-vertical_small">
                                                <span class="slds-badge_lightest">
                                                    <lightning-button variant="brand-outline" label={tenant.zscObjWrapper.Name} title={tenant.zscObjWrapper.Name} value={tenant.zscObjWrapper.Id} icon-name="utility:new_window" icon-position="right" class="slds-m-left_x-small" onclick={navigateToZSCRecPage}></lightning-button>&nbsp;&nbsp;&nbsp;
                                                </span>
                                                <template if:true={tenant.isDecommissionedTenant}>
                                                    <span class="slds-badge slds-theme_info" style="background-color: rgb(255 235 225);color: black; text-align: center;">
                                                        <span class={tenant.ttCustomStyleClass}>
                                                            Tenant Type: {tenant.zscObjWrapper.Cloud_Type__c} &nbsp;&nbsp;||&nbsp;&nbsp; Tenant Status: {tenant.zscObjWrapper.Status__c} &nbsp;&nbsp;||&nbsp;&nbsp; Domain: {tenant.zscObjWrapper.Zscaler_Cloud_Domain__c}
                                                            <template if:true={tenant.displayAssociatedCloud}>
                                                                &nbsp;&nbsp;||&nbsp;&nbsp; Associated Cloud: {tenant.zscObjWrapper.Associated_Cloud__r.Name}
                                                            </template>
                                                            <template if:false={tenant.displayAssociatedCloud}>
                                                                &nbsp;&nbsp;||&nbsp;&nbsp; Associated Cloud: NA
                                                            </template>
                                                            <template if:true={tenant.zscObjWrapper}>
                                                                &nbsp;&nbsp;||&nbsp;&nbsp; Tenant Name: {tenant.zscObjWrapper.Org_Name__c}
                                                            </template>
                                                            <template if:true={tenant.zscObjWrapper}>
                                                                &nbsp;&nbsp;||&nbsp;&nbsp; Reason: {tenant.pgWrapper.Provisioning_Process__c}
                                                            </template>
                                                        </span>
                                                    </span>
                                                </template>
                                                <template if:true={tenant.isNonProvisionedTenant}>
                                                    <span class="slds-badge slds-theme_info" style="background-color: rgb(235 245 255);color: black; text-align: center;">
                                                        <span class={tenant.ttCustomStyleClass}>
                                                            Tenant Type: {tenant.zscObjWrapper.Cloud_Type__c} &nbsp;&nbsp;||&nbsp;&nbsp; Tenant Status: {tenant.zscObjWrapper.Status__c} &nbsp;&nbsp;||&nbsp;&nbsp; Domain: {tenant.zscObjWrapper.Zscaler_Cloud_Domain__c}
                                                            <template if:true={tenant.displayAssociatedCloud}>
                                                                &nbsp;&nbsp;||&nbsp;&nbsp; Associated Cloud: {tenant.zscObjWrapper.Associated_Cloud__r.Name}
                                                            </template>
                                                            <template if:false={tenant.displayAssociatedCloud}>
                                                                &nbsp;&nbsp;||&nbsp;&nbsp; Associated Cloud: NA
                                                            </template>
                                                            <template if:true={tenant.zscObjWrapper}>
                                                                &nbsp;&nbsp;||&nbsp;&nbsp; Tenant Name: {tenant.zscObjWrapper.Org_Name__c}
                                                            </template>
                                                            <template if:true={tenant.isTTUtilityBtnDisabled}>
                                                                &nbsp;&nbsp;||&nbsp;&nbsp; Reason: {tenant.pgWrapper.Provisioning_Process__c}
                                                            </template>
                                                        </span>
                                                    </span>
                                                </template>
                                                <template if:true={tenant.isProvisionedTenant}>
                                                    <span class="slds-badge slds-theme_info" style="background-color: rgb(235 250 240);color: black; text-align: center;">
                                                        <span class={tenant.ttCustomStyleClass}>
                                                            Tenant Type: {tenant.zscObjWrapper.Cloud_Type__c} &nbsp;&nbsp;||&nbsp;&nbsp; Tenant Status: {tenant.zscObjWrapper.Status__c} &nbsp;&nbsp;||&nbsp;&nbsp; Domain: {tenant.zscObjWrapper.Zscaler_Cloud_Domain__c}
                                                            <template if:true={tenant.displayAssociatedCloud}>
                                                                &nbsp;&nbsp;||&nbsp;&nbsp; Associated Cloud: {tenant.zscObjWrapper.Associated_Cloud__r.Name}
                                                            </template>
                                                            <template if:false={tenant.displayAssociatedCloud}>
                                                                &nbsp;&nbsp;||&nbsp;&nbsp; Associated Cloud: NA
                                                            </template>
                                                            <template if:true={tenant.zscObjWrapper}>
                                                                &nbsp;&nbsp;||&nbsp;&nbsp; Tenant Name: {tenant.zscObjWrapper.Org_Name__c}
                                                            </template>
                                                            <template if:true={tenant.isTTUtilityBtnDisabled}>
                                                                &nbsp;&nbsp;||&nbsp;&nbsp; Reason: {tenant.pgWrapper.Provisioning_Process__c}
                                                            </template>
                                                        </span>
                                                    </span>
                                                </template>
                                                <span class="slds-float_right">
                                                    <template if:true={isCurrentUserProfileAndOpptStageAreInvalid}>
                                                            <lightning-button-icon icon-name="utility:add" alternative-text="add sku" title="Add SKU" value={tenant.pgWrapper.Id} onclick={handleAddSKU} class="slds-m-left_x-small" disabled></lightning-button-icon>
                                                            <lightning-button-icon icon-name="utility:attach" alternative-text="add feature" title="Add Feature" value={tenant.pgWrapper.Id} onclick={handleAddFeature} class="slds-m-left_x-small" disabled></lightning-button-icon>
                                                            <lightning-button-icon icon-name="utility:change_request" alternative-text="change platform sku" title="Change Platform SKU" value={tenant.pgWrapper.Id} onclick={handleChangePlatformSKU} class="slds-m-left_x-small" disabled></lightning-button-icon>
                                                            <lightning-button-icon icon-name="utility:lightning_extension" alternative-text="extension request" title="Extension Request" value={tenant.pgWrapper.Id} onclick={handleExtensionRequest} class="slds-m-left_x-small" disabled></lightning-button-icon>
                                                            <lightning-button-icon icon-name="utility:clear" alternative-text="decommission tenant" title="Decommission Tenant" value={tenant.pgWrapper.Id} onclick={handleDecommissionTenant} class="slds-m-left_x-small" disabled></lightning-button-icon>
                                                            <lightning-button-icon icon-name="utility:relate" alternative-text="associate zia" title="Associate ZIA" value={tenant.pgWrapper.Id} onclick={handleAssociateZIA} class="slds-m-left_x-small" disabled></lightning-button-icon>
                                                    </template>
                                                    <template if:false={isCurrentUserProfileAndOpptStageAreInvalid}>
                                                            <lightning-button-icon icon-name="utility:add" alternative-text="add sku" title="Add SKU" value={tenant.pgWrapper.Id} onclick={handleAddSKU} class="slds-m-left_x-small" disabled={tenant.isTTUtilityBtnDisabled}></lightning-button-icon>
                                                            <lightning-button-icon icon-name="utility:attach" alternative-text="add feature" title="Add Feature" value={tenant.pgWrapper.Id} onclick={handleAddFeature} class="slds-m-left_x-small" disabled={tenant.isTTAddFeatureUtilityBtnDisabled}></lightning-button-icon>
                                                            <lightning-button-icon icon-name="utility:change_request" alternative-text="change platform sku" title="Change Platform SKU" value={tenant.pgWrapper.Id} onclick={handleChangePlatformSKU} class="slds-m-left_x-small" disabled={tenant.isTTUtilityBtnDisabled}></lightning-button-icon>
                                                            <lightning-button-icon icon-name="utility:lightning_extension" alternative-text="extension request" title="Extension Request" value={tenant.pgWrapper.Id} onclick={handleExtensionRequest} class="slds-m-left_x-small" disabled={tenant.isTTUtilityBtnDisabled}></lightning-button-icon>
                                                            <lightning-button-icon icon-name="utility:clear" alternative-text="decommission tenant" title="Decommission Tenant" value={tenant.pgWrapper.Id} onclick={handleDecommissionTenant} class="slds-m-left_x-small" disabled={tenant.isTTUtilityBtnDisabled}></lightning-button-icon>
                                                            <lightning-button-icon icon-name="utility:relate" alternative-text="associate zia" title="Associate ZIA" value={tenant.pgWrapper.Id} onclick={handleAssociateZIA} class="slds-m-left_x-small" disabled={tenant.isTTAssociateZIAUtilityBtnDisabled}></lightning-button-icon>
                                                    </template>
                                                    <lightning-button-icon icon-name="utility:picklist_type" alternative-text="tenant history" title="Tenant History" value={tenant} onclick={navigateToTenantHistoryComp} class="slds-m-left_x-small"></lightning-button-icon>
                                                </span>
                                            </div>
                                            <template if:true={tenant.pgWrapper}>
                                                <div class="slds-p-vertical_small">
                                                    <h3 class="slds-section-title--divider slds-m-bottom--small" style="background-color: rgb(238 238 238);color: black;border-radius:25px;text-align: center;">
                                                        <b>Products</b>
                                                    </h3>
                                                    <lightning-datatable 
                                                        key-field="Id" 
                                                        data={tenant.pgWrapper.Provisioning_Products__r} 
                                                        columns={columnsTTNP} 
                                                        hide-checkbox-column=true 
                                                        show-row-number-column=true 
                                                        resize-column-disabled=true 
                                                        class="datatable-custom-style">
                                                    </lightning-datatable>
                                                </div>
                                                <div class="slds-p-vertical_small">
                                                    <h3 class="slds-section-title--divider slds-m-bottom--small" style="background-color: rgb(238 238 238);color: black;border-radius:25px;text-align: center;">
                                                        <b>Contacts</b>
                                                    </h3>
                                                    <lightning-datatable 
                                                        key-field="Id" 
                                                        data={tenant.pgWrapper.Provisioning_Contacts__r} 
                                                        columns={columnsCC} 
                                                        hide-checkbox-column=true 
                                                        show-row-number-column=true 
                                                        resize-column-disabled=true 
                                                        class="datatable-custom-style">
                                                    </lightning-datatable>
                                                </div>
                                            </template>
                                        </lightning-accordion-section>
                                    </template>
                                </template>
                            </template>
                        </lightning-accordion>
                    </template>
                </lightning-tab>
                <lightning-tab label="Subscribed Tenants" value="Subscribed Tenants">
                    <template if:true={isAtleastOneProvisionedSubscribedTenantExists}>
                        <div class="slds-m-around_medium">
                            <lightning-button label="Expand All" variant="brand-outline" disabled={isProvisionedSubscribedTenantExpandAllButtonDisabled} value="Provisioned Subscribed Tenants Accordian Section" class="slds-m-around_small slds-align_absolute_right" onclick={expandAllActiveAccordianSections}></lightning-button>
                            <lightning-button label="Collapse All" variant="brand-outline" disabled={isProvisionedSubscribedTenantCollapseAllButtonDisabled} value="Provisioned Subscribed Tenants Accordian Section" class="slds-m-around_small slds-align_absolute_right" onclick={collapseAllActiveAccordianSections}></lightning-button>
                        </div>
                        <lightning-accordion allow-multiple-sections-open active-section-name={provisionedSubscribedTenantActiveSections}>
                            <template for:each={tenantwrap} for:item="tenant">
                                <template if:true={tenant.isScriptionTenant}>
                                    <lightning-accordion-section name={tenant.zscObjWrapper.Name} label={tenant.zscObjWrapper.Name} style="font-weight: bold;" key={tenant.zscObjWrapper.Name}>
                                        <template if:true={tenant.zscObjWrapper}>
                                            <div class="slds-p-vertical_small">
                                                <span class="slds-badge_lightest">
                                                    <lightning-button variant="brand-outline" label={tenant.zscObjWrapper.Name} title={tenant.zscObjWrapper.Name} value={tenant.zscObjWrapper.Id} icon-name="utility:new_window" icon-position="right" class="slds-m-left_x-small" onclick={navigateToZSCRecPage}></lightning-button>&nbsp;&nbsp;&nbsp;
                                                </span>
                                                <span class="slds-badge slds-theme_info" style="background-color: rgb(235 245 255);color: black; text-align: center;">
                                                    Tenant Type: {tenant.zscObjWrapper.Cloud_Type__c} &nbsp;&nbsp;||&nbsp;&nbsp; Tenant Status: {tenant.zscObjWrapper.Status__c} &nbsp;&nbsp;||&nbsp;&nbsp; Domain: {tenant.zscObjWrapper.Zscaler_Cloud_Domain__c}
                                                    <template if:true={tenant.displayAssociatedCloud}>
                                                        &nbsp;&nbsp;||&nbsp;&nbsp; Associated Cloud: {tenant.zscObjWrapper.Associated_Cloud__r.Name}
                                                    </template>
                                                    <template if:false={tenant.displayAssociatedCloud}>
                                                        &nbsp;&nbsp;||&nbsp;&nbsp; Associated Cloud: NA
                                                    </template>
                                                    
                                                    <template if:true={tenant.zscObjWrapper}>
                                                        &nbsp;&nbsp;||&nbsp;&nbsp; Tenant Name: {tenant.zscObjWrapper.Org_Name__c}
                                                    </template>
                                                </span>
                                                <span class="slds-float_right">
                                                    <lightning-button-icon icon-name="utility:picklist_type" alternative-text="tenant history" title="Tenant History" value={tenant} onclick={navigateToTenantHistoryComp} class="slds-m-left_x-small"></lightning-button-icon>
                                                </span>
                                            </div>
                                        </template>
                                        <template if:true={tenant.pgWrapper}>
                                            <div class="slds-p-vertical_small">
                                                <h3 class="slds-section-title--divider slds-m-bottom--small" style="background-color: rgb(238 238 238);color: black;border-radius:25px;text-align: center;">
                                                    <b>Products</b>
                                                </h3>
                                                <lightning-datatable 
                                                    key-field="Id" 
                                                    data={tenant.pgWrapper.Provisioning_Products__r} 
                                                    columns={columnsST} 
                                                    hide-checkbox-column=true 
                                                    show-row-number-column=true 
                                                    resize-column-disabled=true 
                                                    class="datatable-custom-style">
                                                </lightning-datatable>
                                            </div>
                                            <div class="slds-p-vertical_small">
                                                <h3 class="slds-section-title--divider slds-m-bottom--small" style="background-color: rgb(238 238 238);color: black;border-radius:25px;text-align: center;">
                                                    <b>Contacts</b>
                                                </h3>
                                                <lightning-datatable 
                                                    key-field="Id" 
                                                    data={tenant.pgWrapper.Provisioning_Contacts__r} 
                                                    columns={columnsCC} 
                                                    hide-checkbox-column=true 
                                                    show-row-number-column=true 
                                                    resize-column-disabled=true 
                                                    class="datatable-custom-style">
                                                </lightning-datatable>
                                            </div>
                                        </template>
                                    </lightning-accordion-section>
                                </template>
                            </template>
                        </lightning-accordion>
                    </template>
                </lightning-tab>
            </lightning-tabset>
        </lightning-card>
    </template>

    <template if:true={showZIASelectModalPopUp}>
        <div class="slds-p-vertical_small"></div>
            <div class="slds-modal slds-fade-in-open slds-backdrop">
                <div class="slds-modal__container">
                    <lightning-card>
                    <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse">
                        <lightning-icon icon-name="utility:close" alternative-text="close" variant="inverse" size="small" onclick={closeZIASelectModal}></lightning-icon>
                        <span class="slds-assistive-text">Close</span>
                    </button>
                    <!--HEADER Section-->
                    <div class="slds-modal__header">
                        <h1 id="modal-heading-02" class="slds-modal__title slds-hyphenate">ZIA Association</h1>
                    </div>
                    <!--Body Section-->
                    <div id="modal-content-id-2" class="slds-modal__content slds-p-around_medium" style="height:340px">
                        <template if:true={showSuccess}>
                            <p style="color:green;text-align: center;">Selected ZIA tenant linked successfully.</p>
                        </template>
                        <template if:false={showSuccess}>
                            <p style="text-align: center;">
                                <lightning-combobox
                                    name="progress"
                                    label="Select ZIA Tenant"
                                    value={selectedtenant}
                                    placeholder="select zia tenant"
                                    options={associatedZIA}
                                    onchange={handleZIAAssociation}>
                                </lightning-combobox>
                            </p>
                        </template>
                    </div>
                    <div><br/></div>
                    <div class="slds-align_absolute-center">
                        <lightning-button label="Close" variant="brand-outline" onclick={closeZIASelectModal}></lightning-button>&nbsp;&nbsp;
                        <lightning-button label="Save" variant="brand" onclick={savezia}></lightning-button>
                    </div>
                    </lightning-card>
                    <!--Footer Section-->
                </div>
            </div>
    </template>

    <template if:true={showExtensionModalPopUp}>
        <div class="slds-modal slds-fade-in-open slds-backdrop">
            <div class="slds-modal__container">
                <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse">
                    <lightning-icon icon-name="utility:close" alternative-text="close" variant="inverse" size="small" onclick={closeExtensionModal}></lightning-icon>
                    <span class="slds-assistive-text">Close</span>
                </button>
                <!--HEADER Section-->
                <div class="slds-modal__header">
                    <h1 id="modal-heading-03" class="slds-modal__title slds-hyphenate">Provisioning Group Extension</h1>
                </div>
                <!--Body Section-->
                <div id="modal-content-id-3" class="slds-modal__content slds-p-around_medium slds-scrollable_none" style="height:250px">
                    <div class="slds-align_absolute-left">
                        &nbsp;<lightning-input label="Entension Date" type="date" id="endDate" value={endDateValue} variant="label-inline" disabled></lightning-input>
                        <lightning-textarea label="Extension Reason" type="text" placeholder="type extesnion reason here..." id="extensionReason" value={extensionReason} onchange={handleExtensionReason} variant="label-inline" required></lightning-textarea>
                        <lightning-spinner alternative-text="Loading..." size="small" if:true={isPrExtSpinnerLoading}></lightning-spinner>
                    </div>
                    <div><br/></div>
                    <div class="slds-align_absolute-center">
                        <lightning-button label="Cancel" variant="brand-outline" onclick={closeExtensionModal}></lightning-button>&nbsp;&nbsp;
                        <lightning-button label="Extend" variant="brand" onclick={saveExtension} disabled={isPrExtBtnDisabled}></lightning-button>
                    </div>
                </div>
                <!--Footer Section-->
            </div>
        </div>
    </template>

    <template if:true={showDecommisionModalPopUp}>
        <div class="slds-modal slds-fade-in-open slds-backdrop">
            <div class="slds-modal__container">
                <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse">
                    <lightning-icon icon-name="utility:close" alternative-text="close" variant="inverse" size="small" onclick={closeDecommisionModal}></lightning-icon>
                    <span class="slds-assistive-text">Close</span>
                </button>
                <!--HEADER Section-->
                <div class="slds-modal__header">
                    <h1 id="modal-heading-04" class="slds-modal__title slds-hyphenate">Tenant Decommission</h1>
                </div>
                <!--Body Section-->
                <div id="modal-content-id-4" class="slds-modal__content slds-p-around_medium slds-scrollable_none" style="height:240px">
                    <div class="slds-align_absolute-left">
                        <div class="slds-align_absolute-left">
                            <lightning-radio-group name="tenantDecommRadioOptGroup" label="Do you want to decommission this Tenant?" options={tenantDecommRadioGroupOptions} value={tenantDecommRadioGroupOptionValue} type="radio" onchange={handleTenantDecommRadioGroupOptionChange}></lightning-radio-group>
                        </div>
                        <div><br/></div>
                        <div>
                            <p style="color:orange;text-align: left;">
                                <b><u>Note:</u></b>&nbsp;Before you perform this action, you should have a live conversation with the customer. 
                                Because this action will stop all traffic forwarding. 
                                But at a later date you can re-enable the decommissioned tenant with full configuration intact.
                            </p>
                        </div>
                        <lightning-spinner alternative-text="Loading..." size="small" if:true={isTenantDecommSpinnerLoading}></lightning-spinner>
                    </div>
                    <div><br/></div>
                    <div><br/></div>
                    <div class="slds-align_absolute-center">
                        <lightning-button label="Cancel" variant="brand-outline" onclick={closeDecommisionModal}></lightning-button>&nbsp;&nbsp;
                        <lightning-button label="Decommission" variant="brand" onclick={saveDecommision} disabled={isTenantDecommRadioBtnDisabled}></lightning-button>
                    </div>
                </div>
                <!--Footer Section-->
            </div>
        </div>
    </template>
</template>