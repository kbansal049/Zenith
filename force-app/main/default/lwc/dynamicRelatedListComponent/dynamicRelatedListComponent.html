<template>
    <div class={customStyle}>
        <template if:false={showAccordion}>
            <lightning-card title={strTitle} icon-name="standard:record">
                <div slot="actions">
                    <lightning-button-icon class="slds-p-right_xx-small" onclick={refreshdata}
                        icon-name="utility:refresh" alternative-text="Refresh"></lightning-button-icon>

                    <template if:true={showUnselectAll}>
                        <lightning-button label="Unselect All" onclick={handleUnselectAll}
                            class="slds-m-horizontal_xx-small slds-p-right_xx-small">
                        </lightning-button>
                    </template>
                    <template if:true={showCustomAction}>
                        <lightning-button label={actionName} onclick={handleCustomAction}
                            class="slds-p-right_xx-small slds-m-left_xx-small">
                        </lightning-button>
                    </template>

                    <template if:true={showNew}>
                        <lightning-button label="New" onclick={createNewRec} class="slds-m-left_xx-small">
                        </lightning-button>
                    </template>
                    <template if:true={showMoreActions}>
                        <lightning-button-icon icon-name="utility:down" class="slds-m-left_xx-small">
                        </lightning-button-icon>
                    </template>

                </div>

                <div class="slds-m-around_small divwrp">
                    <template if:true={errmsg}>
                        <div class="slds-box slds-theme_error" style="margin-bottom:5px;">
                            <lightning-formatted-rich-text value={errmsg}></lightning-formatted-rich-text>
                        </div>
                    </template>
                    <c-dynamic-table-component field-set-name={fieldSet} object-name={objectName} record-id={recordId}
                        child-rel-field-name={childRelFieldAPIName} parent-rel-field-name={parentRelFieldAPIName}
                        filter-condition={filterCriteia} show-row-actions={showRowActions} inline-edit={allowInlineEdit}
                        record-actions={recordActionObj} show-standard-view={showStandardView}
                        show-standard-edit={showStandardEdit} show-standard-delete={showStandardDelete}
                        onassignparentid={assignparentId} numofrecords={numofrecords} show-customstyle={showCustomstyle}
                        action-field-set-name={actionFieldSetName} action-field-set-name-edit={actionFieldSetNameEdit}>
                    </c-dynamic-table-component>
                </div>
            </lightning-card>
        </template>
        <template if:true={showAccordion}>
            <lightning-card>
                <div slot="title">
                    <template if:true={showExpanded}>
                        <lightning-button-icon icon-name="utility:chevrondown" variant="bare" onclick={collapse}
                            title="Collapse"></lightning-button-icon>
                    </template>
                    <template if:false={showExpanded}>
                        <lightning-button-icon icon-name="utility:chevronright" variant="bare" onclick={expand}
                            title="Expand">
                        </lightning-button-icon>
                    </template>
                    &nbsp;&nbsp;{strTitle}
                </div>
                <div slot="actions">

                    <template if:true={showUnselectAll}>
                        <lightning-button label="Unselect All" onclick={handleUnselectAll}
                            class="slds-m-horizontal_xx-small slds-p-right_xx-small">
                        </lightning-button>
                    </template>
                    <template if:true={showCustomAction}>
                       <lightning-button label={actionName} onclick={handleCustomAction}
                            class="slds-m-horizontal_xx-small slds-p-right_xx-small">
                        </lightning-button>
                    </template>

                    <template if:true={showExpanded}>
                        <lightning-button-icon class="slds-p-right_xx-small" onclick={refreshdata}
                            icon-name="utility:refresh" alternative-text="Refresh"></lightning-button-icon>
                    </template>
                    <template if:true={showNew}>
                        <lightning-button label="New" onclick={createNewRec} class="slds-m-left_xx-small">
                        </lightning-button>
                    </template>
                    <template if:true={showActions}>
                        <lightning-button-icon icon-name="utility:down" class="slds-m-left_xx-small">
                        </lightning-button-icon>
                    </template>
                </div>
                <template if:true={showExpanded}>
                    <div class="slds-m-around_small divwrp">
                        <template if:true={errmsg}>
                            <div class="slds-box slds-theme_error" style="margin-bottom:5px;">
                                <lightning-formatted-rich-text value={errmsg}></lightning-formatted-rich-text>
                            </div>
                        </template>
                        <c-dynamic-table-component field-set-name={fieldSet} object-name={objectName}
                            record-id={recordId} child-rel-field-name={childRelFieldAPIName}
                            parent-rel-field-name={parentRelFieldAPIName} filter-condition={filterCriteia}
                            show-row-actions={showRowActions} inline-edit={allowInlineEdit}
                            record-actions={recordActionObj} show-standard-view={showStandardView}
                            show-standard-edit={showStandardEdit} show-standard-delete={showStandardDelete}
                            onassignparentid={assignparentId} numofrecords={numofrecords}
                            show-customstyle={showCustomstyle} action-field-set-name={actionFieldSetName}
                            action-field-set-name-edit={actionFieldSetNameEdit}>
                        </c-dynamic-table-component>
                    </div>
                </template>
            </lightning-card>
        </template>
        <template if:true={showcreatenew}>
            <c-dynamic-record-create-component show-modal="true" rt-id={recordTypeId} object-api-name={objectName}
                onstandardcreatesaveevt={handleCreateSave} rel-value={childRelFieldValue}
                rel-api-name={childRelFieldAPIName} onstandardcreatecancelevt={handleCreateCancel}
                defaultvals={defparams} field-set-name={actionFieldSetName}>
            </c-dynamic-record-create-component>
        </template>
    </div>

</template>